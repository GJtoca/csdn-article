> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [blog.csdn.net](https://blog.csdn.net/m0_61712829/article/details/133319855?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22133319855%22%2C%22source%22%3A%22m0_61712829%22%7D)

**ç›®å½•**

[ä¸€ã€è¾“å…¥æ•è·](#%E4%B8%80%E3%80%81%E8%BE%93%E5%85%A5%E6%8D%95%E8%8E%B7)

[1.1 è¾“å…¥æ•è·ç®€ä»‹](#1.1%20%E8%BE%93%E5%85%A5%E6%8D%95%E8%8E%B7%E7%AE%80%E4%BB%8B)

[1.2 è¾“å…¥æ•è·çš„å„éƒ¨åˆ†ç”µè·¯](#t0)

[â€‹ç¼–è¾‘](#t1) 

[1.3 è¾“å…¥æ•è·çš„ä¸»æ¨¡å¼ã€ä»æ¨¡å¼ã€è§¦å‘æºé€‰æ‹©ï¼ˆç®€ç§°ï¼šä¸»ä»è§¦å‘æ¨¡å¼ï¼‰](#t2)

[â€‹ç¼–è¾‘â€‹ç¼–è¾‘](#t3)

[â€‹ç¼–è¾‘ 1.4 è¾“å…¥æ•è·å’Œ PWMI åŸºæœ¬ç»“æ„](#t4)

[äºŒã€é¢‘ç‡çš„æµ‹é‡æ–¹æ³•](#t5)

[2.1 æµ‹é¢‘æ³•](#t6)

[2.2 æµ‹å‘¨æ³•](#t7)

[2.3 æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•çš„è¯¯å·®åˆ†æ](#t8)

[2.4 ç”¨ STM32 æ¥å®ç°æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•](#t9)

[ä¸‰ã€æ‰‹å†Œ](#t10)

[0. æ±Ÿåç§‘æŠ€ / æ±Ÿç§‘å¤§ - STM32 å…¥é—¨æ•™ç¨‹ - å„ç« èŠ‚è¯¦ç»†ç¬”è®° - æŸ¥é˜…ä¼ é€é—¨ - STM32 æ ‡å‡†åº“å¼€å‘_stm32 æ±Ÿåå¤§ csdn-CSDN åšå®¢æ–‡ç« æµè§ˆé˜…è¯» 3.4k æ¬¡ï¼Œç‚¹èµ 47 æ¬¡ï¼Œæ”¶è— 143 æ¬¡ã€‚æ±Ÿåç§‘æŠ€ / æ±Ÿç§‘å¤§ - STM32 æ ‡å‡†åº“å¼€å‘ - å„ç« èŠ‚è¯¦ç»†ç¬”è®° - ä¼ é€é—¨è‡³å„ä¸ªç« èŠ‚ç¬”è®°ã€‚åŸºæœ¬ä¸Šè¯¾ç¨‹è®²çš„æ¯å¥éƒ½è¯¦ç»†è®°å½•ï¼Œæ–¹ä¾¿å›é¡¾ã€‚_stm32 æ±Ÿåå¤§ csdn![](https://i-blog.csdnimg.cn/blog_migrate/be19846480ab44ce477585fc567aeaa0.png)https://blog.csdn.net/m0_61712829/article/details/132434192?spm=1001.2014.3001.5501](https://blog.csdn.net/m0_61712829/article/details/132434192?spm=1001.2014.3001.5501 "0. æ±Ÿåç§‘æŠ€/æ±Ÿç§‘å¤§-STM32å…¥é—¨æ•™ç¨‹-å„ç« èŠ‚è¯¦ç»†ç¬”è®°-æŸ¥é˜…ä¼ é€é—¨-STM32æ ‡å‡†åº“å¼€å‘_stm32æ±Ÿåå¤§ csdn-CSDNåšå®¢")

### ä¸€ã€è¾“å…¥æ•è·  
1.1 è¾“å…¥æ•è·ç®€ä»‹

  
â€ƒâ€ƒè¾“å…¥æ•è·ï¼Œå³ Input Captureï¼Œè‹±æ–‡ç¼©å†™ä¸º ICã€‚è¾“å…¥æ•è·æ¨¡å¼ä¸‹ï¼Œå½“é€šé“è¾“å…¥å¼•è„šå‡ºç°æŒ‡å®šç”µå¹³è·³å˜ç¬é—´ï¼ˆå¯ä»¥å®šä¹‰ä¸ºä¸Šå‡æ²¿ã€ä¸‹é™æ²¿ï¼‰ï¼Œå½“å‰ CNT çš„å€¼å°†è¢«é”å­˜åˆ° CCR ä¸­ï¼ˆæ£€æµ‹ç”µå¹³è·³å˜ï¼Œç„¶åæ‰§è¡ŒåŠ¨ä½œï¼ˆä½œç”¨å’Œå¤–éƒ¨ä¸­æ–­å·®ä¸å¤šï¼Œåªä¸è¿‡å¤–éƒ¨ä¸­æ–­æ‰§è¡Œçš„åŠ¨ä½œæ˜¯å‘ CPU ç”³è¯·ä¸­æ–­ï¼Œè¾“å…¥æ•è·æ‰§è¡Œçš„æ˜¯æ§åˆ¶åç»­ç”µè·¯ï¼‰ï¼‰ï¼Œå¯ç”¨äºæµ‹é‡ PWM æ³¢å½¢çš„é¢‘ç‡ã€å ç©ºæ¯”ã€è„‰å†²é—´éš”ã€ç”µå¹³æŒç»­æ—¶é—´ç­‰å‚æ•°ã€‚åœ¨è¿™é‡Œï¼Œè„‰å†²é—´éš”å’Œé¢‘ç‡å·®ä¸å¤šã€ç”µå¹³æŒç»­æ—¶é—´å’Œå ç©ºæ¯”ä¹Ÿæ˜¯äº’ç›¸å¯¹åº”çš„å…³ç³»ã€‚

Â Â Â Â Â Â Â æ¯ä¸ªé«˜çº§å®šæ—¶å™¨å’Œé€šç”¨å®šæ—¶å™¨éƒ½æ‹¥æœ‰ 4 å„è¾“å…¥æ•è·é€šé“ï¼Œä¸”äºŒè€…æ²¡æœ‰åŒºåˆ«ã€‚åŸºæœ¬å®šæ—¶å™¨æ²¡æœ‰è¾“å…¥æ•è·çš„åŠŸèƒ½ã€‚  
â€ƒâ€ƒè¾“å…¥æ•è·æ¨¡å—å¯ä»¥é…ç½®ä¸º PWMIï¼ˆPWM è¾“å…¥ï¼‰æ¨¡å¼å’Œä¸»ä»è§¦å‘æ¨¡å¼ã€‚PWMI æ¨¡å¼æ˜¯ PWM çš„è¾“å…¥æ¨¡å¼ï¼Œä¸“é—¨ç”¨æ¥åŒæ—¶æµ‹é‡ PWM æ³¢å½¢çš„é¢‘ç‡å’Œå ç©ºæ¯”çš„ã€‚ä¸»ä»è§¦å‘æ¨¡å¼å¯ä»¥å®ç°å¯¹é¢‘ç‡æˆ–å ç©ºæ¯”çš„ç¡¬ä»¶çš„å…¨è‡ªåŠ¨æµ‹é‡ã€‚æŠŠè¿™ä¸¤ä¸ªåŠŸèƒ½ç»“åˆèµ·æ¥ï¼Œæµ‹é‡é¢‘ç‡å’Œå ç©ºæ¯”å°±æ˜¯ç¡¬ä»¶å…¨è‡ªåŠ¨æ‰§è¡Œï¼Œè½¯ä»¶ä¸éœ€è¿›è¡Œä»»ä½•å¹²é¢„ï¼Œä¹Ÿä¸éœ€è¿›ä¸­æ–­ï¼Œéœ€è¦æµ‹é‡çš„æ—¶å€™ï¼Œç›´æ¥è¯»å– CCR å¯„å­˜å™¨å°±è¡Œäº†ï¼Œä½¿ç”¨éå¸¸æ–¹ä¾¿ä¸”æå¤§åœ°å‡è½»äº†è½¯ä»¶çš„å‹åŠ›ã€‚

Â  Â  Â  Â  å¦‚ä¸‹å›¾ï¼Œå·¦è¾¹ä¸ºè¾“å…¥æ•è·ç”µè·¯ï¼Œ4 ä¸ªè¾“å…¥æ•è·å’Œè¾“å‡ºæ¯”è¾ƒé€šé“ï¼Œå…±ç”¨ 4 ä¸ª CCR å¯„å­˜å™¨ï¼Œå¦å¤–å®ƒä»¬çš„ CH1 åˆ° 4 çš„ 4 ä¸ªé€šé“å¼•è„šä¹Ÿæ˜¯å…±ç”¨çš„ï¼Œæ‰€ä»¥å¯¹äºåŒä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¾“å…¥æ•è·å’Œè¾“å‡ºæ¯”è¾ƒåªèƒ½ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚

> è¾“å…¥æ•è·å¯¹æ¯”è¾“å‡ºæ¯”è¾ƒï¼š
> 
> *   è¾“å‡ºæ¯”è¾ƒï¼Œå¼•è„šæ˜¯è¾“å‡ºç«¯å£ï¼Œæ ¹æ® CNT å’Œ CCR çš„å¤§å°å…³ç³»æ¥æ‰§è¡Œè¾“å‡ºåŠ¨ä½œ
> *   è¾“å…¥æ•è·ï¼Œå¼•è„šæ˜¯è¾“å…¥ç«¯å£ï¼Œæ¥æ”¶åˆ°è¾“å…¥ä¿¡å·æ‰§è¡Œ CNT é”å­˜åˆ° CCR çš„åŠ¨ä½œ

#### 1.2 è¾“å…¥æ•è·çš„å„éƒ¨åˆ†ç”µè·¯

Â Â Â Â Â Â Â Â ä»å·¦å‘å³ä¾æ¬¡è¿›è¡Œç”µè·¯åˆ†æï¼š

#### ![](https://i-blog.csdnimg.cn/blog_migrate/4b152c655002d5380d9785af0356c48c.png)Â  Â  Â  Â 

*   æœ€å·¦è¾¹æ˜¯å››ä¸ªé€šé“çš„å¼•è„šï¼Œå‚è€ƒå¼•è„šå®šä¹‰è¡¨ï¼Œå°±æŒ‡å¯¼å¼•è„šæ˜¯å¤ç”¨åœ¨å“ªä¸ªä½ç½®

![](https://i-blog.csdnimg.cn/blog_migrate/35a7524d4843b18f819f3d61d324488d.png)

*   ç„¶åå¼•è„šè¿›æ¥ï¼Œæœ‰ä¸€ä¸ªä¸‰è¾“å…¥çš„å¼‚æˆ–é—¨ï¼Œè¿™ä¸ªå¼‚æˆ–é—¨çš„è¾“å…¥æ¥åœ¨äº†é€šé“ 1ã€2ã€3 ç«¯å£ï¼Œå¼‚æˆ–é—¨çš„æ‰§è¡Œé€»è¾‘æ˜¯ï¼Œå½“ä¸‰ä¸ªå¼•è„šçš„ä»»ä½•ä¸€ä¸ªæœ‰ç”µå¹³ç¿»è½¬æ—¶ï¼Œè¾“å‡ºå¼•è„šå°±äº§ç”Ÿä¸€æ¬¡ç”µå¹³ç¿»è½¬ï¼Œ3 ä¸ªå¼•è„šç”µå¹³éƒ½ç›¸åŒä¸º 0ï¼Œ3 ä¸ªå¼•è„šä¸­æœ‰é«˜æœ‰ä½ä¸º 1ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/21e6bd31ef7ca438b3fca207b42450b2.png)

*   ç„¶åè¾“å‡ºé€šè¿‡æ•°æ®é€‰æ‹©å™¨ï¼Œåˆ°è¾¾è¾“å…¥æ•è·é€šé“ 1ï¼Œæ•°æ®é€‰æ‹©å™¨å¦‚æœé€‰æ‹©ä¸Šé¢ä¸€ä¸ªï¼Œé‚£è¾“å…¥æ•è·é€šé“ 1 çš„è¾“å…¥å°±æ˜¯ä¸‰ä¸ªå¼•è„šçš„å¼‚æˆ–å€¼ï¼›è‹¥é€‰æ‹©ä¸‹é¢ä¸€ä¸ªï¼Œå¼‚æˆ–é—¨å°±æ²¡æœ‰ç”¨ã€‚è®¾è®¡å¼‚æˆ–é—¨ï¼Œå…¶å®è¿˜æ˜¯ä¸ºäº†ä¸‰ç›¸æ— åˆ·ç”µæœºæœåŠ¡çš„ï¼Œæ— åˆ·ç”µæœºæœ‰ä¸‰ä¸ªéœå°”ä¼ æ„Ÿå™¨æ£€æµ‹è½¬å­çš„ä½ç½®ï¼Œå¯ä»¥æ ¹æ®è½¬å­çš„ä½ç½®æ¥è¿›è¡Œæ¢ç›¸ã€‚
    

![](https://i-blog.csdnimg.cn/blog_migrate/dbd74a4aa81946219d05f625e59b7211.png)

*   è¾“å…¥ä¿¡å·æ¥åˆ°äº†è¾“å…¥æ»¤æ³¢å™¨å’Œè¾¹æ²¿æ£€æµ‹å™¨ï¼ˆææ€§é€‰æ‹©ï¼‰ã€‚è¾“å…¥æ»¤æ³¢å™¨å¯ä»¥å¯¹ä¿¡å·è¿›è¡Œæ»¤æ³¢ï¼Œé¿å…ä¸€äº›é«˜é¢‘çš„æ¯›åˆºä¿¡å·è¯¯è§¦å‘ï¼›è¾¹æ²¿æ£€æµ‹å™¨å°±æ˜¯å’Œå¤–éƒ¨ä¸­æ–­ä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©é«˜ç”µå¹³è§¦å‘æˆ–è€…ä½ç”µå¹³è§¦å‘ï¼Œå½“å‡ºç°æŒ‡å®šçš„ç”µå¹³æ—¶ï¼Œè¾¹æ²¿æ£€æµ‹ç”µè·¯å°±ä¼šè§¦å‘åç»­ç”µè·¯æ‰§è¡ŒåŠ¨ä½œã€‚è®¾è®¡äº†ä¸¤å¥—æ»¤æ³¢å’Œè¾¹æ²¿æ£€æµ‹ç”µè·¯ï¼Œç¬¬ä¸€å¥—ç”µè·¯ç»è¿‡æ»¤æ³¢å’Œææ€§é€‰æ‹©å¾—åˆ° TI1FP1ï¼Œè¾“å…¥ç»™é€šé“ 1 çš„åç»­ç”µè·¯ã€‚ç¬¬äºŒå¥—ç”µè·¯ï¼Œç»è¿‡å¦ä¸€ä¸ªæ»¤æ³¢å’Œææ€§é€‰æ‹©ï¼Œå¾—åˆ° TI1FP2ï¼Œè¾“å…¥ç»™é€šé“ 2 çš„åç»­ç”µè·¯ï¼ŒåŒç†ï¼Œä¸‹é¢ TI2 ä¿¡å·è¿›æ¥ï¼Œä¹Ÿç»è¿‡ä¸¤å¥—æ»¤æ³¢å’Œææ€§é€‰æ‹©å¾—åˆ° TI2FP1 è¾“å…¥é€šé“ 1 å’Œ TI2FP2 è¾“å…¥é€šé“ 2ã€‚å¯ä»¥è¿›è¡Œäº¤å‰è¿æ¥ï¼Œä¾‹å¦‚ CH1 å¼•è„šè¾“å…¥ç»™é€šé“ 2ï¼ŒCH2 å¼•è„šè¾“å…¥ç»™é€šé“ 1ï¼Œè¿›è¡Œäº¤å‰è¿æ¥çš„ç›®çš„æ˜¯ä¸¤ä¸ªï¼š1. ä¸€ä¸ªé€šé“çµæ´»åˆ‡æ¢ä¸¤ä¸ªå¼•è„šï¼Œå¯ä»¥çµæ´»åˆ‡æ¢åç»­æ•è·ç”µè·¯çš„è¾“å…¥ï¼Œ2. ä¸¤ä¸ªé€šé“åŒæ—¶æ•è·ä¸€ä¸ªå¼•è„šï¼Œå¯ä»¥æŠŠä¸€ä¸ªå¼•è„šçš„è¾“å…¥ï¼ŒåŒæ—¶æ˜ å°„åˆ°ä¸¤ä¸ªæ•è·å•å…ƒï¼Œè¿™ä¹Ÿæ˜¯ PWMI æ¨¡å¼çš„ç»å…¸ç»“æ„ï¼Œå®ç°ä¸¤ä¸ªé€šé“ï¼ˆICï¼‰å¯¹ä¸€ä¸ªå¼•è„šï¼ˆCHï¼‰è¿›è¡Œæ•è·ï¼Œå°±å¯ä»¥åŒæ—¶æµ‹é‡é¢‘ç‡å’Œå ç©ºæ¯”ã€‚å¯ä»¥é€‰æ‹©å„è‡ªç‹¬ç«‹è¿æ¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è¿›è¡Œäº¤å‰è¿æ¥ã€‚å¦å¤–è¿˜æœ‰ä¸€ä¸ª TRC ä¿¡å·ï¼Œä¹Ÿå¯é€‰æ‹©ä½œä¸ºæ•è·éƒ¨åˆ†çš„è¾“å…¥ï¼ŒTRC ä¿¡å·æ¥æºäºæœ€ä¸Šé¢ï¼Œè®¾è®¡ä¹Ÿæ˜¯ä¸ºäº†æ— åˆ·ç”µæœºçš„é©±åŠ¨ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/364f02dff444ff8d9c14e7a4823da362.png)

*   ç„¶åæ¥åˆ°äº†é¢„åˆ†é¢‘å™¨ã€‚æ¯ä¸ªé€šé“å„æœ‰ä¸€ä¸ªé¢„åˆ†é¢‘å™¨ï¼Œå¯ä»¥é€‰æ‹©å¯¹å‰é¢çš„ä¿¡å·è¿›è¡Œåˆ†é¢‘ï¼Œåˆ†é¢‘ä¹‹åçš„è§¦å‘ä¿¡å·ï¼Œå°±å¯ä»¥è§¦å‘ç”µè·¯è¿›è¡Œå·¥ä½œäº†ï¼Œæ¯æ¥ä¸€ä¸ªè§¦å‘ä¿¡å·ï¼ŒCNT çš„å€¼å°±ä¼šå‘ CCR è½¬è¿ä¸€æ¬¡ï¼Œè½¬è¿çš„åŒæ—¶ä¼šå‘ç”Ÿä¸€ä¸ªæ•è·äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šåœ¨çŠ¶æ€å¯„å­˜å™¨ç½®æ ‡å¿—ä½ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥äº§ç”Ÿä¸­æ–­ï¼Œå¦‚æœéœ€è¦åœ¨æ•è·çš„ç¬é—´ï¼Œå¤„ç†ä¸€äº›äº‹æƒ…çš„è¯ï¼Œå°±å¯ä»¥å¼€å¯è¿™ä¸ªæ•è·ä¸­æ–­ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸Šå‡æ²¿è§¦å‘æ•è·ï¼Œæ¯æ¥ä¸€ä¸ªä¸Šå‡æ²¿ï¼ŒCNT è½¬è¿åˆ° CCR ä¸€æ¬¡ï¼Œåˆå› ä¸º CNT è®¡æ•°å™¨æ˜¯ç”±å†…éƒ¨çš„æ ‡å‡†æ—¶é’Ÿé©±åŠ¨çš„ï¼Œæ‰€ä»¥ CNT çš„æ•°å€¼å¯ä»¥ç”¨æ¥è®°å½•ä¸¤ä¸ªä¸Šå‡æ²¿ä¹‹é—´çš„æ—¶é—´é—´éš”ï¼ˆå‘¨æœŸï¼‰å†å–å€’æ•°å°±æ˜¯æµ‹å‘¨æ³•æµ‹é‡çš„é¢‘ç‡äº†ï¼Œåœ¨ä¸€æ¬¡æ•è·åå°† CNT æ¸…é›¶ï¼ˆå¯ä»¥ç”¨ä¸»ä»è§¦å‘æ¨¡å¼æ¥è‡ªåŠ¨å®Œæˆ CNT æ¸…é›¶ï¼‰

![](https://i-blog.csdnimg.cn/blog_migrate/388c51a129252c70d122744eddbac6d0.png)

  
â€ƒâ€ƒè¾“å…¥æ•è·é€šé“ 1 çš„è¯¦ç»†æ¡†å›¾å¦‚ä¸‹æ‰€ç¤ºï¼šï¼ˆå¦‚ä¸‹æ˜¯ä¸Šé¢æ¡†å›¾çš„ä¸€ä¸ªç»†åŒ–ç»“æ„ï¼ŒåŸºæœ¬åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼‰

![](https://i-blog.csdnimg.cn/blog_migrate/52eee81a40d2c25b2bc9d1110590d7b5.png)

Â  Â  Â  Â  Â å¦‚ä¸Šå›¾ï¼Œç”µè·¯ç»†èŠ‚å†…å®¹å¦‚ä¸‹ï¼š

*   å¼•è„šè¿›æ¥ï¼Œå…ˆç»è¿‡ä¸€ä¸ªæ»¤æ³¢å™¨ï¼Œæ»¤æ³¢å™¨çš„è¾“å…¥æ˜¯ TI1 å°±æ˜¯ CH1 çš„å¼•è„šï¼Œè¾“å‡ºçš„ TI1F å°±æ˜¯æ»¤æ³¢åçš„ä¿¡å·
    
*   FDTS æ˜¯æ»¤æ³¢å™¨çš„é‡‡æ ·æ—¶é’Ÿæ¥æº
    
*   CCMR1 å¯„å­˜å™¨é‡Œçš„ ICF ä½å¯ä»¥æ§åˆ¶æ»¤æ³¢å™¨çš„å‚æ•°
    
*   æ»¤æ³¢å™¨çš„å·¥ä½œåŸç†å°±æ˜¯ï¼šä»¥é‡‡æ ·é¢‘ç‡å¯¹è¾“å…¥ä¿¡å·è¿›è¡Œé‡‡æ ·ï¼Œå½“è¿ç»­ N ä¸ªå€¼éƒ½ä¸ºé«˜ç”µå¹³ï¼Œè¾“å‡ºæ‰ä¸ºé«˜ç”µå¹³ï¼Œå½“è¿ç»­ N ä¸ªå€¼éƒ½ä¸ºä½ç”µå¹³ï¼Œè¾“å‡ºæ‰ä¸ºä½ç”µå¹³ï¼Œå¦‚æœä¿¡å·å‡ºç°é«˜é¢‘æŠ–åŠ¨ï¼Œå¯¼è‡´è¿ç»­é‡‡æ · N ä¸ªå€¼ä¸å…¨éƒ½ä¸€æ ·ï¼Œé‚£è¾“å‡ºå°±ä¸ä¼šå˜åŒ–ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°æ»¤æ³¢çš„æ•ˆæœã€‚é‡‡æ ·é¢‘ç‡è¶Šä½ï¼Œé‡‡æ ·ä¸ªæ•° N è¶Šå¤§ï¼Œæ»¤æ³¢æ•ˆæœå°±è¶Šå¥½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœæ³¢å½¢å™ªå£°æ¯”è¾ƒå¤§ï¼Œå°±å¯ä»¥æŠŠ IC1F ä½å‚æ•°è®¾ç½®å¤§ä¸€ç‚¹æ¥è¿‡æ»¤å™ªå£°ã€‚
    
*   æ»¤æ³¢ä¹‹åçš„ä¿¡å·é€šè¿‡è¾¹æ²¿æ£€æµ‹å™¨ã€‚æ•è·ä¸Šå‡æ²¿æˆ–è€…ä¸‹é™æ²¿
    
*   CCER å¯„å­˜å™¨é‡Œçš„ CC1P ä½å¯ä»¥è¿›è¡Œææ€§é€‰æ‹©
    
*   æœ€ç»ˆå¾—åˆ° TI1FP1 è§¦å‘ä¿¡å·
    
*   é€šè¿‡æ•°æ®é€‰æ‹©å™¨ï¼Œè¿›å…¥é€šé“ 1 åç»­çš„æ•è·ç”µè·¯ã€‚
    

![](https://i-blog.csdnimg.cn/blog_migrate/0a50a4da1577abdbda02be9a66b5ca58.png)

*   å½“ç„¶è¿˜æœ‰ä¸€å¥—ä¸€æ ·çš„ç”µè·¯å¾—åˆ° TI1FP2 è§¦å‘ä¿¡å·ï¼Œè¿é€šåˆ°é€šé“ 2 çš„åç»­ç”µè·¯ï¼Œä¸Šå›¾å¹¶æ²¡æœ‰ç”»å‡ºæ¥ï¼ŒåŒæ ·ï¼Œé€šé“ 2 æœ‰ TI2FP1 è¿é€šåˆ°é€šé“ 1 çš„åç»­ï¼Œé€šé“ 2 ä¹Ÿæœ‰ TI2FP2 è¿é€šåˆ°é€šé“ 2 çš„åç»­ï¼Œæ€»å…±æœ‰å››ç§è¿æ¥æ–¹å¼ï¼Œç„¶åç»è¿‡æ•°æ®é€‰æ‹©å™¨ï¼Œè¿›å…¥åç»­æ•è·éƒ¨åˆ†ç”µè·¯
*   CCMR å¯„å­˜å™¨çš„ CC1S ä½å¯ä»¥å¯¹æ•°æ®é€‰æ‹©å™¨è¿›è¡Œé€‰æ‹©
*   ä¹‹åï¼ŒCCMR å¯„å­˜å™¨çš„ ICPS ä½å¯ä»¥é…ç½®åˆ†é¢‘å™¨ï¼Œå¯ä»¥é€‰æ‹©ä¸åˆ†é¢‘ã€2 åˆ†é¢‘ã€4 åˆ†é¢‘ã€8 åˆ†é¢‘
*   CCMR å¯„å­˜å™¨çš„ CC1E ä½ï¼Œæ§åˆ¶è¾“å‡ºä½¿èƒ½æˆ–å¤±èƒ½ã€‚å¦‚æœä½¿èƒ½äº†è¾“å‡ºï¼Œè¾“å…¥ç«¯äº§ç”ŸæŒ‡å®šè¾¹æ²¿ä¿¡å·ï¼Œç»è¿‡å±‚å±‚ç”µè·¯ï¼Œå°±å¯ä»¥æœ€åå°† CNT çš„å€¼è½¬è¿åˆ° CCR é‡Œæ¥ï¼Œæ¯æ•è·ä¸€æ¬¡ CNT çš„å€¼ï¼Œéƒ½è¦æŠŠ CNT æ¸… 0 ä¸€ä¸‹ï¼Œä»¥ä¾¿äºä¸‹ä¸€æ¬¡çš„æ•è·ï¼Œä»æ¨¡å¼æ§åˆ¶å™¨å°±å¯ä»¥åœ¨æ•è·ä¹‹åè‡ªåŠ¨å®Œæˆ CNT çš„æ¸…é›¶å·¥ä½œ
*   TI1FP1 ä¿¡å·å’Œ TI1F_ED è¾¹æ²¿ä¿¡å·ï¼Œéƒ½å¯ä»¥é€šå‘ä»æ¨¡å¼æ§åˆ¶å™¨ï¼Œæ¯”å¦‚ TI1FP1 ä¿¡å·çš„ä¸Šå‡æ²¿è§¦å‘æ•è·ï¼Œè¿˜å¯ä»¥åŒæ—¶è§¦å‘ä»æ¨¡å¼ï¼Œè¿™ä¸ªä»æ¨¡å¼é‡Œå°±æœ‰ç”µè·¯ï¼Œå¯ä»¥è‡ªåŠ¨å®Œæˆ CNT çš„æ¸…é›¶ã€‚ä»æ¨¡å¼å°±æ˜¯å®Œæˆè‡ªåŠ¨åŒ–æ“ä½œçš„åˆ©å™¨

![](https://i-blog.csdnimg.cn/blog_migrate/faefcb11d19d943c9728f8ee75c656e1.png)

####   
1.3 è¾“å…¥æ•è·çš„ä¸»æ¨¡å¼ã€ä»æ¨¡å¼ã€è§¦å‘æºé€‰æ‹©ï¼ˆç®€ç§°ï¼šä¸»ä»è§¦å‘æ¨¡å¼ï¼‰

![](https://i-blog.csdnimg.cn/blog_migrate/efdb8eda1677e0f3b82d5cbfc1aa66ce.png)

â€ƒâ€ƒCCR å¯¹ CNT è¿›è¡Œæ•è·ä¹‹åï¼Œéœ€è¦å¯¹ CNT è¿›è¡Œä¸€æ¬¡æ¸… 0 æ“ä½œï¼Œè¿™æ ·æ¯æ¬¡æ•è·å¾—åˆ°çš„å€¼æ‰æ˜¯æµ‹å‘¨æ³•ï¼Œä¸¤ä¸ªä¸Šå‡æ²¿ï¼ˆä¸‹é™æ²¿ï¼‰ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚è¿™ä¸ªæ¸… 0 æ“ä½œï¼Œå°±éœ€è¦ç”¨åˆ°ä¸»ä»è§¦å‘æ¨¡å¼æ¥è‡ªåŠ¨å®Œæˆã€‚ç”±è¾“å…¥æ•è·é€šé“ 1 çš„è¯¦ç»†æ¡†å›¾å¯å¾—ï¼šç»è¿‡æ»¤æ³¢å’Œææ€§é€‰æ‹©çš„ TI1FP1 ä¿¡å·å’Œç»è¿‡æ»¤æ³¢çš„è¾¹æ²¿ä¿¡å· TI1F_ED éƒ½å¯ä»¥é€šå‘ä»æ¨¡å¼æ§åˆ¶å™¨ï¼Œä¹‹åä¾¿å¯ä»¥é€šè¿‡ç¡¬ä»¶ç”µè·¯è‡ªåŠ¨å®Œæˆ CNT çš„æ¸… 0 æ“ä½œã€‚  
â€ƒâ€ƒä¸»ä»è§¦å‘æ¨¡å¼ï¼Œå³ä¸»æ¨¡å¼ã€ä»æ¨¡å¼å’Œè§¦å‘æºé€‰æ‹©ä¸‰ä¸ªåŠŸèƒ½çš„ç®€ç§°ã€‚ä¸»æ¨¡å¼å¯ä»¥å°†å®šæ—¶å™¨å†…éƒ¨çš„ä¿¡å·æ˜ å°„åˆ° TRGO å¼•è„šï¼Œç”¨äºè§¦å‘å…¶ä»–å¤–è®¾çš„æ“ä½œï¼›ä»æ¨¡å¼å¯ä»¥æ¥æ”¶å…¶ä»–å¤–è®¾æˆ–è‡ªèº«å¤–è®¾çš„ä¸€äº›ä¿¡å·ï¼Œç”¨äºè§¦å‘è‡ªå·±çš„ä¸€äº›æ“ä½œï¼ˆå®šæ—¶å™¨çš„è¿è¡Œï¼‰ï¼›è§¦å‘æºé€‰æ‹©ï¼Œå³é€‰æ‹©ä»æ¨¡å¼çš„è§¦å‘ä¿¡å·æºåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä»æ¨¡å¼çš„ä¸€éƒ¨åˆ†ã€‚  
â€ƒâ€ƒåœ¨ä»æ¨¡å¼ä¸‹ï¼Œå¯ä»¥é€šè¿‡è§¦å‘æºé€‰æ‹©åŠŸèƒ½é€‰æ‹©ä¸€ä¸ªä¿¡å·äº§ç”Ÿ TRGI ä¿¡å·ï¼Œä¹‹åå»è§¦å‘ä»æ¨¡å¼ï¼Œä»æ¨¡å¼å¯ä»¥åœ¨ä¸Šé¢åˆ—è¡¨ä¸­é€‰æ‹©ä¸€é¡¹æ“ä½œæ¥è‡ªåŠ¨æ‰§è¡Œã€‚å…³äºä¸»ä»æ¨¡å¼çš„è¯¦ç»†è¯´æ˜å¯ä»¥å‚è§æ‰‹å†Œï¼š

#### ![](https://i-blog.csdnimg.cn/blog_migrate/1cee83cfe5d7ecc95607d8e1cab1bc78.png)![](https://i-blog.csdnimg.cn/blog_migrate/4b0c481f78b80af1262dfc4d6bc15248.png)

#### ![](https://i-blog.csdnimg.cn/blog_migrate/adb265eb30187cf787a9fdf1d054139e.png)  
1.4 è¾“å…¥æ•è·å’Œ PWMI åŸºæœ¬ç»“æ„

1.4.1 è¾“å…¥æ•è·åŸºæœ¬ç»“æ„Â Â 

Â Â Â Â Â Â Â Â ä¸‹å›¾æ˜¯è¾“å‡ºæ•è·æ¨¡å¼æµ‹é¢‘ç‡çš„åŸºæœ¬ç»“æ„å›¾ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/21a39c3329530545d06acc239ef2ec53.png)  
â€ƒâ€ƒä¸Šå›¾æ¸…æ™°åœ°å±•ç¤ºäº†è¾“å…¥æ•è·æ¨¡å¼æµ‹é‡é¢‘ç‡çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¼–ç¨‹çš„é€»è¾‘åŸºç¡€ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬åªä½¿ç”¨äº†ä¸€ä¸ªé€šé“ï¼Œæ‰€ä»¥å®ƒåªèƒ½æµ‹é‡é¢‘ç‡ã€‚  
â€ƒâ€ƒé¦–å…ˆï¼Œé…ç½®æ—¶åŸºå•å…ƒï¼Œå¯åŠ¨å¯„å­˜å™¨ï¼Œåˆ™ CNT å°±ä¼šåœ¨é¢„åˆ†é¢‘ä¹‹åçš„æ—¶é’Ÿé©±åŠ¨ä¸‹ä¸æ–­è‡ªå¢ã€‚æµ‹å‘¨æ³•ç”¨ CNT æ¥è®¡æ•°ï¼Œé—´æ¥å®ç°è®¡æ—¶çš„åŠŸèƒ½ã€‚ç»è¿‡é¢„åˆ†é¢‘åçš„æ—¶é’Ÿé¢‘ç‡ï¼Œå°±æ˜¯æµ‹å‘¨æ³•çš„æ ‡å‡†é¢‘ç‡ fcã€‚ä¹‹åï¼ŒGPIO è¾“å…¥ä¸€ä¸ªå¾…æµ‹çš„æ–¹æ³¢ä¿¡å·ï¼Œç»è¿‡ç»è¿‡æ»¤æ³¢å™¨å’Œè¾¹æ²¿æ£€æµ‹é€‰æ‹© TI1FP1 ä¸ºä¸Šå‡æ²¿è§¦å‘ï¼Œä¹‹åæ•°æ®é€‰æ‹©å™¨é€‰æ‹©ç›´è¿é€šé“ï¼Œåˆ†é¢‘å™¨é€‰æ‹©ä¸åˆ†é¢‘ã€‚å½“ TI1FP1 å‡ºç°ä¸Šå‡æ²¿ä¹‹åï¼ŒCNT çš„å€¼å°±ä¼šè¢« CCR1 è½¬è¿æ•è·ï¼›åŒæ—¶è§¦å‘æºé€‰æ‹©æ¨¡å—é€‰æ‹© TI1FP1 ä¸ºè§¦å‘ä¿¡å·ï¼Œä»æ¨¡å¼é€‰æ‹©å¤ä½æ“ä½œï¼Œè§¦å‘ CNT æ¸…é›¶ï¼ˆå…ˆåé¡ºåºæ˜¯ï¼šå…ˆè½¬è¿ CNT çš„å€¼åˆ° CCRï¼Œå†è§¦å‘ä»æ¨¡å¼ç»™ CNT æ¸…é›¶ã€‚æˆ–è€…æ˜¯éé˜»å¡çš„åŒæ—¶è½¬ç§»ï¼šCNT çš„å€¼è½¬ç§»åˆ° CCRï¼ŒåŒæ—¶ 0 è½¬ç§»åˆ° CNT é‡Œé¢å»ï¼Œæ€»ä¹‹æ˜¯å…ˆæ•è·ï¼Œå†æ¸…é›¶ï¼‰ã€‚å½“ç”µè·¯ä¸æ–­å·¥ä½œæ—¶ï¼ŒCCR1 ä¸­çš„å€¼å§‹ç»ˆæ˜¯æœ€æ–°ä¸€ä¸ªå‘¨æœŸçš„è®¡æ•°å€¼ï¼Œå³æµ‹å‘¨æ³•çš„è®¡æ¬¡æ•° Nã€‚æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬æƒ³è¯»å–ä¿¡å·çš„é¢‘ç‡æ—¶ï¼Œåªéœ€è¦è¯»å– CCR1 å¾—åˆ° Nï¼Œå†è®¡ç®— fc/N å°±å¾—åˆ°é¢‘ç‡äº†ã€‚å½“ä¸éœ€è¦è¯»å–æ—¶ï¼Œæ•´ä¸ªç”µè·¯å…¨è‡ªåŠ¨çš„æµ‹é‡ï¼Œä¸éœ€è¦å ç”¨ä»»ä½•è½¯ä»¶èµ„æºã€‚

> â€ƒâ€ƒè¿™é‡Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š
> 
> *   CNT çš„è®¡æ•°å€¼æ˜¯æœ‰ä¸Šé™çš„ã€‚ç”±äº ARR æœ€å¤§ä¸º 65535ï¼Œæ•… CNT æœ€å¤§ä¹Ÿåªèƒ½è®¡ 65535 ä¸ªæ•°ã€‚å¦‚æœä¿¡å·é¢‘ç‡å¤ªä½ï¼ŒCNT çš„è®¡æ•°å€¼å¯èƒ½ä¼šæº¢å‡ºã€‚
> *   ä»æ¨¡å¼çš„è§¦å‘æºé€‰æ‹©ä¸­æœ‰ TI1FP1 å’Œ TI2FP2ï¼Œä½†æ˜¯æ²¡æœ‰ TI3 å’Œ TI4 çš„ä¿¡å·ã€‚æ‰€ä»¥å¦‚æœè¦ä½¿ç”¨ä»æ¨¡å¼è‡ªåŠ¨æ¸…é›¶ CNTï¼Œå°±å¿…é¡»ä½¿ç”¨é€šé“ 1 æˆ–é€šé“ 2 ä½œä¸ºè¾“å…¥ã€‚å¯¹äºé€šé“ 3 å’Œé€šé“ 4ï¼Œå°±åªèƒ½å¼€å¯æ•è·ä¸­æ–­ï¼Œåœ¨ä¸­æ–­ä¸­æ‰‹åŠ¨æ¸… 0 äº†ï¼ˆç¨‹åºä¼šå¤„äºé¢‘ç¹ä¸­æ–­çš„çŠ¶æ€ï¼Œæ¯”è¾ƒå ç”¨è½¯ä»¶èµ„æºï¼‰ã€‚

1.4.2 PWMI åŸºæœ¬ç»“æ„

![](https://i-blog.csdnimg.cn/blog_migrate/59cfa7f390cabe8cc4e7f4fe14ae5285.png)

Â  Â  Â  Â  PWMI æ¨¡å¼ä½¿ç”¨ä¸¤ä¸ªé€šé“åŒæ—¶æ•è·ä¸€ä¸ªå¼•è„šï¼Œå¯ä»¥åŒæ—¶æµ‹é‡å‘¨æœŸå’Œå ç©ºæ¯”ï¼Œç›¸æ¯”å‰é¢è¾“å…¥æ•è·ï¼Œä¸‹é¢å¤šäº†ä¸€ä¸ª TI1FP2 çš„é€šé“ã€‚

Â Â Â Â Â Â Â Â é¦–å…ˆ TI1FP1 é…ç½®ä¸Šå‡æ²¿è§¦å‘ï¼Œè§¦å‘æ•è·å’Œæ¸…é›¶ CNTï¼Œæ­£å¸¸çš„æ•è·å‘¨æœŸï¼Œå†æ¥ä¸€ä¸ª TI1FP2ï¼Œé…ç½®ä¸ºä¸‹é™æ²¿è§¦å‘ï¼Œé€šè¿‡äº¤å‰é€šé“å»è§¦å‘é€šé“ 2 çš„æ•è·å•å…ƒï¼ˆæœ€å¼€å§‹ä¸Šå‡æ²¿ CCR1 æ•è·åŒæ—¶æ¸…é›¶ CNTï¼Œä¹‹å CNT ä¸€ç›´åŠ ï¼Œç„¶ååœ¨ä¸‹é™æ²¿æ—¶åˆ»è§¦å‘ CCR2 æ•è·ï¼Œè¿™æ—¶ CCR2 çš„å€¼å°±æ˜¯ CNT ä»ä¸Šå‡æ²¿åˆ°ä¸‹é™æ²¿çš„è®¡æ•°å€¼ä¹Ÿå°±æ˜¯é«˜ç”µå¹³æœŸé—´çš„è®¡æ•°å€¼ï¼ŒCCR2 æ•è·å¹¶ä¸è§¦å‘ CNT æ¸…é›¶ï¼Œæ‰€ä»¥ CNT ç»§ç»­åŠ ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡ä¸Šå‡æ²¿ï¼ŒCCR1 æ•è·å‘¨æœŸå¹¶ CNT æ¸…é›¶ï¼Œè¿™æ ·æ‰§è¡Œä¹‹å CCR1 å°±æ˜¯ä¸€æ•´ä¸ªå‘¨æœŸçš„è®¡æ•°å€¼ï¼ŒCCR2 å°±æ˜¯é«˜ç”µå¹³æœŸé—´çš„è®¡æ•°å€¼ï¼Œç”¨ CCR2/CCR1 å°±æ˜¯å ç©ºæ¯”ï¼Œä»¥ä¸Šå°±æ˜¯ PWMI æ¨¡å¼ä½¿ç”¨ä¸¤ä¸ªé€šé“æ¥æ•è·é¢‘ç‡å’Œå ç©ºæ¯”çš„æ€è·¯ã€‚å¦å¤–ä¹Ÿå¯ä»¥ä¸¤ä¸ªé€šé“åŒæ—¶æ•è·ç¬¬ä¸€ä¸ªå¼•è„šçš„è¾“å…¥ï¼‰

### äºŒã€é¢‘ç‡çš„æµ‹é‡æ–¹æ³•

![](https://i-blog.csdnimg.cn/blog_migrate/9e926e74c08a03b9411ccf1b796ece2b.png)

â€ƒâ€ƒå¦‚ä¸Šå›¾æ˜¯é¢‘ç‡é€æ¸é™ä½çš„æ–¹æ³¢æ³¢å½¢ï¼Œè¶Šå¾€å·¦é¢‘ç‡è¶Šé«˜ï¼Œè¶Šå¾€å³é¢‘ç‡è¶Šä½ï¼Œè¿™é‡Œä¿¡å·éƒ½æ˜¯åªæœ‰é«˜ä½ç”µå¹³çš„æ•°å­—ä¿¡å·ï¼Œå¯¹äº STM32 æµ‹é¢‘ç‡è€Œè¨€ï¼Œå®ƒä¹Ÿæ˜¯åªèƒ½æµ‹é‡æ•°å­—ä¿¡å·çš„ã€‚å¦‚æœéœ€è¦æµ‹é‡ä¸€ä¸ªæ­£å¼¦æ³¢åˆ™éœ€è¦æ­å»ºä¸€ä¸ªä¿¡å·é¢„å¤„ç†ç”µè·¯ï¼Œæœ€ç®€å•çš„å°±æ˜¯ç”¨è¿æ”¾æ­å»ºä¸€ä¸ªæ¯”è¾ƒå™¨ï¼ŒæŠŠæ­£å¼¦æ³¢è½¬æ¢ä¸ºæ•°å­—ä¿¡å·å†è¾“å…¥ç»™ STM32 å°±è¡Œäº†ï¼›å¦‚æœä½ æµ‹é‡çš„ä¿¡å·ç”µå‹éå¸¸é«˜ï¼Œé‚£è¿˜è¦è€ƒè™‘éš”ç¦»çš„é—®é¢˜ï¼Œæ¯”å¦‚ä½¿ç”¨éš”ç¦»æ”¾å¤§å™¨ã€ç”µå‹äº’æ„Ÿå™¨ç­‰å…ƒä»¶ï¼Œéš”ç¦»é«˜å‹ç«¯å’Œä½å‹ç«¯ï¼Œä¿è¯ç”µè·¯çš„å®‰å…¨ã€‚æ€»ä¹‹ï¼Œç»è¿‡å¤„ç†æœ€ç»ˆè¾“å…¥ç»™ STM32 çš„ä¿¡å·æ˜¯å¦‚ä¸Šå›¾çš„é«˜ä½ç”µå¹³ä¿¡å·ï¼Œé«˜ç”µå¹³ 3.3vï¼Œä½ç”µå¹³ 0vã€‚

Â Â Â Â Â Â Â Â ä¸ºäº†æµ‹é‡é¢‘ç‡ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥é€‰æ‹©ï¼šæµ‹é¢‘æ³•ã€æµ‹å‘¨æ³•

Â Â Â Â Â Â Â Â æµ‹é¢‘æ³•ï¼šå®šæ—¶å™¨ä¸­æ–­ï¼Œå¹¶è®°å½•æ•è·æ¬¡æ•°ï¼›æµ‹å‘¨æ³•ï¼šæ•è·ä¸­æ–­ï¼Œå¹¶è®°å½•å®šæ—¶å™¨æ¬¡æ•°ã€‚

#### 2.1 æµ‹é¢‘æ³•

  
â€ƒâ€ƒæµ‹é¢‘æ³•çš„æµ‹è¯•æ–¹æ³•ï¼ˆç›´æ¥æŒ‰é¢‘ç‡å®šä¹‰æ¥è¿›è¡Œæµ‹é‡çš„æ–¹æ³•ï¼‰æ˜¯ï¼šåœ¨é—¸é—¨æ—¶é—´ T å†…ï¼Œå¯¹ä¸Šå‡æ²¿ï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸‹é™æ²¿ï¼‰è®¡æ¬¡ï¼Œå¾—åˆ° Nï¼Œåˆ™å¾…æµ‹ä¿¡å·é¢‘ç‡ğ‘“ğ‘¥ ä¸ºï¼šÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ğ‘“ğ‘¥ = ğ‘ / ğ‘‡

![](https://i-blog.csdnimg.cn/blog_migrate/5d0b95ece141e88b1b7fc3dca89176c7.png)

â€ƒâ€ƒä¾‹å¦‚ï¼Œå¯ä»¥å®šä¹‰é—¸é—¨æ—¶é—´é—¸é—¨æ—¶é—´ T=1s ï¼ˆç ¸é—¨æ—¶é—´ä¸æ˜¯å¿…é¡»ä¸º 1sï¼‰ï¼Œåˆ™åœ¨ä¸€ç§’ä¸­å¾—åˆ°çš„ä¸Šå‡æ²¿çš„ä¸ªæ•°ï¼ˆæ¯æ¥ä¸€ä¸ªä¸Šå‡æ²¿å°±æ˜¯å®Œæ•´çš„ä¸€ä¸ªå‘¨æœŸçš„ä¿¡å·ä¸ªæ•°ï¼‰å°±æ˜¯é¢‘ç‡

> é¢‘ç‡çš„å®šä¹‰å°±æ˜¯ï¼Œ1s å†…å‡ºç°äº†å¤šå°‘ä¸ªé‡å¤çš„å‘¨æœŸï¼Œé‚£é¢‘ç‡å°±æ˜¯å¤šå°‘ Hz

#### 2.2 æµ‹å‘¨æ³•

  
â€ƒâ€ƒæµ‹å‘¨æ³•çš„æµ‹è¯•æ–¹æ³•æ˜¯ï¼šä¸¤ä¸ªä¸Šå‡æ²¿å†…ï¼Œä»¥æ ‡å‡†é¢‘ç‡ fc è®¡æ¬¡ï¼Œfc=72M/ï¼ˆpsc+1ï¼‰ï¼Œå¾—åˆ° N(å°±æ˜¯è¯»å– CCR çš„å€¼ï¼‰ï¼Œåˆ™æµ‹é‡é¢‘ç‡ğ‘“ğ‘¥ä¸ºï¼š  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ğ‘“ğ‘¥ = ğ‘“ğ‘ / ğ‘Â 

![](https://i-blog.csdnimg.cn/blog_migrate/1dc6e53344f4ec0118aacbd670a06302.png)

â€ƒâ€ƒæµ‹å‘¨æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå‘¨æœŸçš„å€’æ•°å°±æ˜¯é¢‘ç‡ã€‚å¦‚æœæˆ‘ä»¬èƒ½ç”¨å®šæ—¶å™¨æµ‹é‡å‡ºä¸€ä¸ªå‘¨æœŸçš„æ—¶é—´ï¼ˆç›¸é‚»ä¸Šå‡æ²¿æˆ–ç›¸é‚»ä¸‹é™æ²¿çš„é—´éš”æ—¶é—´ï¼‰å–å€’æ•°å³å¾—åˆ°æµ‹é‡é¢‘ç‡ã€‚

Â  Â  Â  Â  æ•è·ä¿¡å·çš„ä¸¤ä¸ªä¸Šå‡æ²¿ï¼Œç„¶åæµ‹é‡ä¸€ä¸‹ä¸¤ä¸ªä¸Šå‡æ²¿ä¹‹é—´æŒç»­çš„æ—¶é—´ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªç²¾åº¦æ— ç©·å¤§çš„ç§’è¡¨æ¥æµ‹é‡æ—¶é—´ï¼Œæµ‹é‡æ—¶é—´çš„æ–¹æ³•ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯å®šæ—¶å™¨è®¡æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå·²çŸ¥çš„æ ‡å‡†é¢‘ç‡ fc çš„è®¡æ¬¡æ—¶é’Ÿæ¥é©±åŠ¨è®¡æ•°å™¨ï¼Œä»ä¸€ä¸ªä¸Šå‡æ²¿å¼€å§‹è®¡æ•°å™¨ä» 0 å¼€å§‹ä¸€ç›´è®¡åˆ°ä¸‹ä¸€ä¸ªä¸Šå‡æ²¿åœæ­¢ï¼Œè®¡ä¸€ä¸ªæ•°çš„æ—¶é—´æ˜¯ 1/fcï¼Œè®¡ N ä¸ªæ•°æ—¶é—´å°±æ˜¯ N/fc ä¹Ÿå°±æ˜¯å‘¨æœŸï¼Œå†å–å€’æ•°å°±å¾—åˆ°äº†é¢‘ç‡ fx

Â  Â  Â  Â è¾“å…¥æ•è·æ¨¡å—é‡‡ç”¨æµ‹å‘¨æ³•è¿›è¡Œæµ‹é‡ã€‚

#### 2.3 æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•çš„è¯¯å·®åˆ†æ

  
â€ƒâ€ƒæµ‹é¢‘æ³•é€‚ç”¨äºæµ‹é‡é«˜é¢‘ä¿¡å·ï¼Œæµ‹å‘¨æ³•é€‚ç”¨äºæµ‹é‡ä½é¢‘ä¿¡å·ã€‚

Â Â Â Â Â Â Â Â æ ¹æ®ä¸Šå›¾å¯ä»¥æ¸…æ™°åœ°çœ‹å‡ºï¼Œæµ‹é¢‘æ³•åœ¨é—¸é—¨æ—¶é—´å†…ï¼Œæœ€å¥½è¦å¤šå‡ºç°ä¸€äº›ä¸Šå‡æ²¿ï¼Œè®¡æ¬¡æ•°é‡å¤šä¸€äº›æœ‰åŠ©äºå‡å°è¯¯å·®ï¼Œæµ‹é¢‘æ³•è¦æ±‚ä¿¡å·é¢‘ç‡è¦ç¨å¾®é«˜ä¸€äº›ï¼Œæµ‹é¢‘æ³•çš„æµ‹é‡ç»“æœæ›´æ–°æ…¢ä¸€äº›ï¼Œæµ‹é‡ç»“æœæ˜¯ä¸€æ®µæ—¶é—´çš„å¹³å‡å€¼ï¼Œå€¼æ¯”è¾ƒå¹³æ»‘ï¼Œæ•°å€¼ç›¸å¯¹ç¨³å®šï¼›å¯¹äºæµ‹å‘¨æ³•ï¼Œå°±è¦æ±‚ä¿¡å·é¢‘ç‡ä½ä¸€äº›ï¼Œä½é¢‘ä¿¡å·ï¼Œå‘¨æœŸæ¯”è¾ƒé•¿ï¼Œè®¡æ¬¡å°±ä¼šæ¯”è¾ƒå¤šï¼Œæœ‰åŠ©äºå‡å°è¯¯å·®ï¼Œæµ‹å‘¨æ³•çš„æµ‹é‡ç»“æœæ›´æ–°çš„å¿«ï¼Œåªæµ‹é‡ä¸€ä¸ªå‘¨æœŸï¼Œå°±èƒ½å‡ºä¸€æ¬¡ç»“æœï¼Œæ•°æ®è·³å˜ä¹Ÿéå¸¸å¿«ï¼Œæ‰€ä»¥å‡ºç»“æœçš„é€Ÿåº¦å–å†³äºå¾…æµ‹ä¿¡å·çš„é¢‘ç‡ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¾…æµ‹ä¿¡å·éƒ½æ˜¯å‡ ç™¾ hz å‡ åƒ hzï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæµ‹å‘¨æ³•ç»“æœæ›´æ–°æ›´å¿«ï¼Œä½†æ˜¯ç”±äºå®ƒåªæµ‹é‡ä¸€ä¸ªå‘¨æœŸï¼Œæ‰€ä»¥ç»“æœå€¼ä¼šå—å™ªå£°çš„å½±å“ï¼Œæ³¢åŠ¨æ¯”è¾ƒå¤§ï¼Œè¿™å°±æ˜¯è¿™ä¸¤ç§æ–¹æ³•çš„åŸºæœ¬ç‰¹å¾å¯¹æ¯”ã€‚

Â  Â  Â  Â  æµ‹é¢‘æ³•è®¡æ¬¡å’Œæµ‹å‘¨æ³•è®¡æ¬¡ï¼Œè¿™ä¸ªè®¡æ¬¡æ•°é‡ N å°½é‡è¦å¤§ä¸€äº›ï¼ŒN è¶Šå¤§ï¼Œç›¸å¯¹è¯¯å·®è¶Šå°ï¼Œå› ä¸ºåœ¨è¿™äº›æ–¹æ³•ä¸­ï¼Œè®¡æ¬¡å¯èƒ½å­˜åœ¨æ­£è´Ÿ 1 è¯¯å·®ï¼Œè¦æƒ³å‡å°æ­£è´Ÿ 1 è¯¯å·®ï¼Œå°±å°½é‡å¤šè®°ä¸€äº›æ•°ï¼Œå½“è®¡æ¬¡ N æ¯”è¾ƒå¤§æ—¶ï¼Œæ­£è´Ÿ 1 å¯¹ N çš„å½±å“å°±ä¼šå¾ˆå°  
â€ƒâ€ƒç”±äºæµ‹é‡åŸç†çš„å·®å¼‚ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œæµ‹é¢‘æ³•çš„ç»“æœæ›´æ–°é¢‘ç‡ä¼šæ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯æ•°å€¼è¾ƒä¸ºç¨³å®šï¼›æµ‹å‘¨æ³•çš„ç»“æœæ›´æ–°é¢‘ç‡è¾ƒå¿«ï¼Œæ•°æ®è·³å˜ä¹Ÿæ¯”è¾ƒçµæ•ã€‚ä»åŸç†ä¸Šçœ‹ï¼Œæµ‹é¢‘æ³•è‡ªå¸¦ä¸€ä¸ªå‡å€¼æ»¤æ³¢çš„åŠŸèƒ½ï¼Œå¦‚æœåœ¨é—¸é—¨æ—¶é—´ T å†…è¢«æµ‹é¢‘ç‡æœ‰å˜åŒ–ï¼Œæµ‹é¢‘æ³•å¾—åˆ°çš„å®é™…æ˜¯è¿™ä¸€æ®µé—¸é—¨æ—¶é—´å†…çš„å¹³å‡é¢‘ç‡ï¼›è€Œæµ‹å‘¨æ³•åªæµ‹é‡ä¸€ä¸ªå‘¨æœŸï¼Œæ•…å…¶ç»“æœä¼šå—å™ªå£°çš„å½±å“ï¼Œæ³¢åŠ¨ä¼šæ¯”è¾ƒå¤§ã€‚æ‰€ä»¥ï¼Œå¯¹äºæµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•çš„ä¸€ä¸ªå…±åŒç‚¹æ˜¯ï¼šN è¶Šå¤§ï¼Œè¯¯å·®å°±è¶Šå°ã€‚åœ¨ä¸¤ç§æ–¹æ³•ä¸­ï¼Œè®¡æ¬¡éƒ½å¯èƒ½ä¼šäº§ç”Ÿæ­£è´Ÿ 1 è¯¯å·®ã€‚åœ¨æµ‹é¢‘æ³•çš„ä¸€ä¸ªé—¸é—¨æ—¶é—´å†…ï¼Œå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªè¢«æµ‹ä¿¡å·çš„å‘¨æœŸéƒ½æ˜¯å®Œæ•´çš„ï¼›æµ‹å‘¨æ³•çš„æ ‡å‡†è®¡æ•°ä¿¡å·çš„ä¿¡å·ä¹Ÿä¸ä¸€å®šæ˜¯è¢«æµ‹ä¿¡å·çš„æ•´æ•°å€ï¼Œæ‰€ä»¥å®ƒä¹Ÿä¸ä¸€å®šæ˜¯æ¯ä¸€ä¸ªéƒ½å®Œæ•´çš„ã€‚å¯¹äºä¸Šè¿°çš„ä¸¤ç§æƒ…å†µï¼Œéƒ½ä¼šå‡ºç°å¤šè®¡ä¸€ä¸ªæ•°æˆ–è€…å°‘è®¡ä¸€ä¸ªæ•°çš„æƒ…å†µï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿæ­£è´Ÿ 1 è¯¯å·®ã€‚  
â€ƒâ€ƒå¦‚ä½•åœ¨ä¸åŒæƒ…å†µä¸‹æ­£ç¡®é€‰æ‹©æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•å‘¢ï¼Ÿæ‰€ä»¥å¤šé«˜ç®—é«˜é¢‘ï¼Œå¤šä½ç®—ä½é¢‘ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸€ä¸ªå‚æ•°æ¥è€ƒé‡ï¼šä¸­ç•Œé¢‘ç‡ï¼Œæµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•è¯¯å·®ç›¸ç­‰çš„é¢‘ç‡ç‚¹ã€‚ç”±äºä¸¤ç§æ–¹æ³•çš„è¯¯å·®éƒ½ä¸ N çš„æ­£è´Ÿ 1 è¯¯å·®æœ‰å…³ï¼Œæ‰€ä»¥å½“ä¸¤ç§æ–¹æ³•è®¡æ¬¡çš„ N ç›¸åŒæ—¶ï¼Œä¸¤ç§æ–¹æ³•çš„è¯¯å·®ä¹Ÿå°±ç›¸åŒã€‚æ¶ˆå»ä¸¤ç§æ–¹æ³•å…¬å¼ä¸­çš„ Nï¼Œå°†æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•çš„ N æå‡ºæ¥ï¼Œä»¤ä¸¤ä¸ªæ–¹æ³• N ç›¸ç­‰ï¼Œå°† fx è§£å‡ºæ¥ï¼Œå¯å¾—ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/dc2de7ee4350c10fd5f19fcfad87a7c7.png)

å¼ä¸­ï¼ŒT æ˜¯æµ‹é¢‘æ³•çš„é—¸é—¨æ—¶é—´ï¼ŒfÂ c æ˜¯æµ‹é¢‘æ³•çš„æ ‡å‡†é¢‘ç‡ã€‚

Â  Â  Â  Â  å½“å¾…æµ‹ä¿¡å·é¢‘ç‡å°äºä¸­ç•Œé¢‘ç‡æ—¶ï¼Œæµ‹å‘¨æ³•è¯¯å·®æ›´å°ï¼Œé€‰æ‹©æµ‹å‘¨æ³•æ›´åˆé€‚ï¼›å½“å¾…æµ‹ä¿¡å·é¢‘ç‡å¤§äºä¸­ç•Œé¢‘ç‡æ—¶ï¼Œæµ‹é¢‘æ³•è¯¯å·®æ›´å°ï¼Œé€‰æ‹©æµ‹é¢‘æ³•æ›´åˆé€‚ã€‚

#### 2.4 ç”¨ STM32 æ¥å®ç°æµ‹é¢‘æ³•å’Œæµ‹å‘¨æ³•

Â Â Â Â Â Â Â æµ‹é¢‘æ³•ï¼Œä¹‹å‰å­¦è¿‡çš„å¤–è®¾å¯ä»¥å®ç°ï¼Œå¯¹å°„å¼çº¢å¤–ä¼ æ„Ÿå™¨è®¡æ¬¡ã€å®šæ—¶å™¨å¤–éƒ¨æ—¶é’Ÿï¼Œè¿™äº›ä»£ç ç¨åŠ æ”¹è¿›å°±æ˜¯æµ‹é¢‘æ³•ï¼Œæ¯”å¦‚Â å¯¹å°„å¼çº¢å¤–ä¼ æ„Ÿå™¨è®¡æ¬¡ï¼Œæ¯æ¥ä¸€ä¸ªä¸Šå‡æ²¿è®¡æ¬¡ + 1ï¼Œå†ç”¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šä¸€ä¸ª 1s çš„å®šæ—¶ä¸­æ–­ï¼Œåœ¨ä¸­æ–­é‡Œï¼Œæ¯éš” 1s å–ä¸€ä¸‹è®¡æ¬¡å€¼ï¼ŒåŒæ—¶æ¸… 0ï¼Œä¸ºä¸‹ä¸€æ¬¡åšå‡†å¤‡ï¼Œè¿™æ ·æ¯æ¬¡è¯»å–çš„è®¡æ¬¡å€¼å°±ç›´æ¥æ˜¯é¢‘ç‡ï¼›å¯¹åº”å®šæ—¶å™¨å¤–éƒ¨æ—¶é’Ÿçš„ä»£ç ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ¯éš” 1s å–ä¸€ä¸‹è®¡æ¬¡ï¼Œå°±èƒ½å®ç°æµ‹é¢‘æ³•æµ‹é‡é¢‘ç‡çš„åŠŸèƒ½äº†ã€‚

Â  Â  Â  Â  æœ¬èŠ‚è¾“å…¥æ•è·æµ‹é¢‘ç‡ï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯æµ‹å‘¨æ³•ã€‚å°±æ˜¯æµ‹é‡ä¸¤ä¸ªä¸Šå‡æ²¿ä¹‹é—´çš„æ—¶é—´ï¼Œæ¥è¿›è¡Œé¢‘ç‡æµ‹é‡ã€‚

### ä¸‰ã€æ‰‹å†Œ

Â Â Â Â Â Â Â Â æ‰‹å†Œæœ¬èŠ‚ç›¸åº”çš„å†…å®¹ï¼Œæè¿°æ˜¯å¯„å­˜å™¨çš„æ–¹å¼ï¼Œç»“åˆä¸Šé¢ç¬”è®°å†…å®¹è¿›è¡Œè¿›ä¸€æ­¥ç†è§£

> *   æ‰‹å†Œä¸­ï¼ŒÂ  è„‰å†²å®½åº¦æµ‹é‡å°±æ˜¯å ç©ºæ¯”ï¼ŒÂ  å‘¨æœŸæµ‹é‡å°±æ˜¯é¢‘ç‡
> *   ä¸»è¦ç†è§£ï¼Œä»æ¨¡å¼é…åˆè¾“å…¥æ•è·å®Œæˆç¡¬ä»¶è‡ªåŠ¨åŒ–

![](https://i-blog.csdnimg.cn/blog_migrate/c09aff5015230af55acf88cbd5904506.png)![](https://i-blog.csdnimg.cn/blog_migrate/9b3c379941721bf478df15f5765947f1.png)![](https://i-blog.csdnimg.cn/blog_migrate/b2b32bdaa8ff3a552010feec18a8e6e5.png)